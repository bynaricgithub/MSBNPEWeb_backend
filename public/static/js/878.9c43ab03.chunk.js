"use strict";(self.webpackChunkmnc_frontend=self.webpackChunkmnc_frontend||[]).push([[878],{7878:(e,a,t)=>{t.r(a),t.d(a,{default:()=>x});var s=t(9950),l=t(3939),i=t(2902),n=t(2776),d=t(9324),c=t(4959),r=t(5385),o=t(7965),m=t(1261),u=t(9671),g=t(6030),h=t(4414);const x=()=>{var e;const{categories:a}=(0,g.A)("imageCategories"),[t,x]=(0,s.useState)([]),[j,y]=(0,s.useState)([]),[p,b]=(0,s.useState)(!0),[f,v]=(0,s.useState)(""),[N,C]=(0,s.useState)(!1),[w,A]=(0,s.useState)(null),[S,k]=(0,s.useState)({modal:!1,data:null});(0,s.useEffect)((()=>{(async()=>{b(!0);try{const e=await r.A.get("/admin/gallery/listing");if("success"!==e.data.status||!Array.isArray(e.data.data))throw new Error(e.data.message||"Invalid response");x(e.data.data)}catch(e){(0,u.WU)({message:e.message,displayClass:"failure"})}finally{b(!1)}})()}),[N,S]),(0,s.useEffect)((()=>{if(!a.length)return;b(!0);const e=f?t.filter((e=>String(e.category)===String(f))):t,s=Object.fromEntries(a.map((e=>[String(e.value),e.label]))),l=e.sort(((e,a)=>{var t,s;return(null!==(t=e.order_id)&&void 0!==t?t:0)-(null!==(s=a.order_id)&&void 0!==s?s:0)})).map(((e,a)=>({...e,srno:a+1,categoryName:s[String(e.category)]||"N/A",image:(0,h.jsx)("img",{src:`https://mncsite.bynaricexam.com/data/${e.image}`,alt:e.title,width:200}),actions:(0,h.jsxs)("div",{className:"d-flex gap-2 justify-content-center",children:[(0,h.jsx)("button",{type:"button",className:"btn btn-sm btn-warning",onClick:()=>{A(e),C(!0)},children:(0,h.jsx)(c.g,{icon:d.LFz})}),(0,h.jsx)("button",{type:"button",className:"btn btn-sm btn-danger ms-2",onClick:()=>k({modal:!0,data:e}),children:(0,h.jsx)(c.g,{icon:d.yLS})}),(0,h.jsx)("div",{className:"text-center p-1",children:(0,h.jsx)(n.A.Check,{defaultChecked:1===e.status,type:"switch",id:`switch-${e.id}`,onClick:a=>async function(e){let{id:a,status:t}=e;try{const e=await r.A.put("/gallery/disable",{id:a,status:t});(0,u.WU)({message:e.data.message,displayClass:e.data.status})}catch(s){(0,u.WU)({message:s.message,displayClass:"failure"})}}({id:e.id,status:a.target.checked?1:0})})})]})})));y(l),b(!1)}),[t,a,f]);return(0,h.jsxs)("div",{className:"px-3",children:[(0,h.jsx)("h3",{className:"text-center p-2",children:"Manage Gallery"}),(0,h.jsxs)("button",{className:"btn btn-success rounded-5 mb-3",onClick:()=>{A(null),C(!0)},children:[(0,h.jsx)(c.g,{icon:d.QLR})," Add New Gallery"]}),(0,h.jsx)("div",{className:"float-end mb-3",children:(0,h.jsxs)("select",{className:"form-select",value:f,onChange:e=>{v(e.target.value)},children:[(0,h.jsx)("option",{value:"",children:"All Categories"}),a.map((e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value)))]})}),(0,h.jsx)("div",{className:"depttableSection my-3",children:p?(0,h.jsx)(o.A,{}):(0,h.jsx)(m.A,{data:j,columns:[{text:"Sr.No.",dataField:"srno"},{text:"Title",dataField:"title"},{text:"Category",dataField:"categoryName"},{text:"Image",dataField:"image"},{text:"Actions",dataField:"actions"}],keyField:"srno",headerClasses:"admin-allTable_header",sortingTable:"gallery",noDataIndication:()=>(0,h.jsx)("div",{children:"No images found."})})}),(0,h.jsxs)(i.A,{centered:!0,size:"lg",show:N,onHide:()=>C(!1),children:[(0,h.jsx)(i.A.Header,{className:"bgTheme text-light",children:(0,h.jsx)(i.A.Title,{children:w?"Edit Gallery Item":"Add Gallery Item"})}),(0,h.jsx)(i.A.Body,{children:(0,h.jsx)(l.l1,{enableReinitialize:!0,initialValues:{id:(null===w||void 0===w?void 0:w.id)||"",title:(null===w||void 0===w?void 0:w.title)||"",category:(null===w||void 0===w?void 0:w.category)||"",image:null},onSubmit:e=>w?async function(e){e.image&&(await(0,u.Wi)(w.image),e.image=await(0,u.aj)(e.image));const a=new FormData;Object.entries(e).forEach((e=>{let[t,s]=e;return a.append(t,s)}));try{const e=await r.A.put("/gallery/update",a,{headers:{"Content-Type":"multipart/form-data"}});(0,u.WU)({message:e.data.message,displayClass:e.data.status}),C(!1)}catch(t){(0,u.WU)({message:t.message,displayClass:"failure"})}}(e):async function(e){if(!e.image)return void(0,u.WU)({message:"Please select an image",displayClass:"failure"});e.image=await(0,u.aj)(e.image);const a=new FormData;Object.entries(e).forEach((e=>{let[t,s]=e;return a.append(t,s)}));try{const e=await r.A.post("/gallery/add",a,{headers:{"Content-Type":"multipart/form-data"}});(0,u.WU)({message:e.data.message,displayClass:e.data.status}),C(!1)}catch(t){(0,u.WU)({message:t.message,displayClass:"failure"})}}(e),children:e=>{let{setFieldValue:t,values:s}=e;return(0,h.jsxs)(l.lV,{children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-6",children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsx)(l.D0,{name:"title",className:"form-control",placeholder:"Title"}),(0,h.jsx)("label",{children:"Title"}),(0,h.jsx)(l.Kw,{name:"title",component:"div",className:"text-danger"})]})}),(0,h.jsx)("div",{className:"col-6",children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsxs)(l.D0,{as:"select",name:"category",className:"form-select",children:[(0,h.jsx)("option",{value:"",children:"Select Category"}),a.map((e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,h.jsx)("label",{children:"Category"}),(0,h.jsx)(l.Kw,{name:"category",component:"div",className:"text-danger"})]})}),(0,h.jsx)("div",{className:"col-12",children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsx)("input",{type:"file",accept:"image/*",className:"form-control",onChange:e=>t("image",e.currentTarget.files[0])}),(0,h.jsx)("label",{children:"Upload Image"}),(0,h.jsx)(l.Kw,{name:"image",component:"div",className:"text-danger"})]})}),s.image&&(0,h.jsx)("div",{className:"col-12 text-center mb-3",children:(0,h.jsx)("img",{src:URL.createObjectURL(s.image),alt:"preview",width:150})})]}),(0,h.jsxs)("div",{className:"text-center",children:[(0,h.jsx)("button",{type:"submit",className:"btn btn-primary mx-2",children:"Submit"}),(0,h.jsx)("button",{type:"button",className:"btn btn-secondary mx-2",onClick:()=>C(!1),children:"Cancel"})]})]})}})})]}),(0,h.jsxs)(i.A,{centered:!0,show:S.modal,onHide:()=>k({modal:!1,data:null}),children:[(0,h.jsx)(i.A.Header,{children:(0,h.jsx)(i.A.Title,{children:"Confirm Delete"})}),(0,h.jsxs)(i.A.Body,{children:["Are you sure you want to delete ",(0,h.jsx)("strong",{children:null===(e=S.data)||void 0===e?void 0:e.title}),"?"]}),(0,h.jsxs)(i.A.Footer,{children:[(0,h.jsx)("button",{className:"btn btn-danger",onClick:()=>async function(e){try{await(0,u.Wi)(e.image);const a=await r.A.delete("/gallery/delete",{params:{id:e.id}});(0,u.WU)({message:a.data.message,displayClass:a.data.status}),k({modal:!1,data:null})}catch(a){(0,u.WU)({message:a.message,displayClass:"failure"})}}(S.data),children:"Delete"}),(0,h.jsx)("button",{className:"btn btn-secondary",onClick:()=>k({modal:!1,data:null}),children:"Cancel"})]})]})]})}}}]);