"use strict";(self.webpackChunkmnc_frontend=self.webpackChunkmnc_frontend||[]).push([[146],{3146:(e,a,s)=>{s.r(a),s.d(a,{default:()=>v});var t=s(9324),l=s(4959),n=s(3939),i=s(9950),d=s(2902),r=s(2776),o=s(5385),c=s(7965),u=s(9671),m=s(8799),h=s(4414);const p=e=>{let{list:a,onUpdate:s,parent_id:t}=e;const[l,n]=(0,i.useState)([]),[d,r]=(0,i.useState)(!1);(0,i.useEffect)((()=>{n(a)}),[a]);const o=()=>l.map((e=>(0,h.jsx)("li",{className:"list-group-item list-group-item-action",children:e.label},e.id)));return(0,h.jsxs)("div",{children:[(0,h.jsxs)("ul",{className:"list-group",children:[!d&&o(),d&&(0,h.jsx)(m.ReactSortable,{list:l,setList:n,animation:300,delayOnTouchStart:!0,delay:2,children:o()})]}),(0,h.jsxs)("div",{className:"text-center",children:[!d&&(0,h.jsx)("button",{type:"button",className:"btn btn-primary m-2",onClick:e=>r(!0),children:"Edit"}),d&&s&&(0,h.jsx)("button",{type:"button",className:"btn btn-primary m-2",onClick:e=>{r(!1),s(l,t)},children:"Save"}),d&&(0,h.jsx)("button",{type:"button",className:"btn btn-danger m-2",onClick:e=>r(!1),children:"Cancel"})]})]})};var x=s(1261);const v=()=>{var e;const[a,s]=(0,i.useState)(),[m,v]=(0,i.useState)(),[j,b]=(0,i.useState)(!1),[f,g]=(0,i.useState)(!1),[y,_]=(0,i.useState)(!1),[k,N]=(0,i.useState)(),[C,w]=(0,i.useState)(!1),[F,S]=(0,i.useState)(),[L,A]=(0,i.useState)([]),[U,M]=(0,i.useState)({modal:!1,data:""});function D(e){let a=[];e.forEach(((e,s,t)=>{let l={id:"",label:"",link:"",order_id:"",parent_id:""};e.id===e.parent_id&&(l.id=e.id,l.label=e.title,l.link=e.menu_url,l.order_id=e.order_id,l.parent_id=e.parent_id,a.push(l))})),e=e.filter((e=>!a.find((a=>a.id===e.id)))),a.forEach((a=>{a.subMenu=T(e,a.id)})),S(a),E([{id:0,parent_id:"#",label:"Main Menu",subMenu:a}])}function T(e,a){let s=[];return null===e||void 0===e||e.forEach((t=>{let l={id:"",label:"",link:"",order_id:"",parent_id:"",subMenu:[]};t.parent_id===a&&(l.id=t.id,l.label=t.title,l.link=t.menu_url,l.order_id=t.order_id,l.parent_id=t.parent_id,l.subMenu=T(e.filter((e=>e.id!==t.id)),t.id),s.push(l))})),s}const W=e=>{let{item:a}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{style:{marginLeft:"20px"},children:["#"===a.link&&"| -\ud83d\udcc1 ","#"!==a.link&&(0,h.jsx)(h.Fragment,{children:"| - \ud83c\udf10 "}),a.label,"\xa0",(0,h.jsx)("a",{href:a.link&&a.link.includes("http")?a.link:"https://mncsite.bynaricexam.com/"+a.link.slice(1),target:"_blank",rel:"noopener noreferrer","data-bs-toggle":"tooltip","data-bs-placement":"right",title:"https://mncsite.bynaricexam.com/"+a.link.slice(1),children:(0,h.jsx)(l.g,{icon:t.Ju_})})]}),a.subMenu&&(0,h.jsx)("div",{style:{marginLeft:"40px"},children:a.subMenu.map(((e,a)=>(0,h.jsx)(W,{item:e},a)))})]})},P=(e,a,s)=>{let t="";return function e(a,s,l){if(s!=a){let a=l.find((e=>e.id===s));return a&&(t+=" -> "+a.title,a.id!==a.parent_id&&e(a.id,a.parent_id,l)),t}}(e,a,s)},E=e=>{e.length>0&&e.sort(((e,a)=>e.order_id-a.order_id)).forEach((e=>{e.subMenu.length>0&&(A((s=>[...s,(0,h.jsx)("div",{className:"col-xl-3 col-lg-3 col-sm-4",children:(0,h.jsx)("div",{className:"masonry-item",children:(0,h.jsxs)("div",{className:"card fade-in-top mb-3",style:{cursor:"default",userSelect:"none"},children:[(0,h.jsxs)("div",{className:"card-header",style:{color:"white",backgroundColor:"var(--theme)"},children:[(0,h.jsx)("b",{children:e.label}),a&&e.parent_id!==e.id&&P(e.id,e.parent_id,a)]}),(0,h.jsx)("div",{className:"card-body",children:(0,h.jsx)(p,{parent_id:e.parent_id,list:e.subMenu.sort(((e,a)=>e.order_id-a.order_id)),onUpdate:(e,a)=>async function(e,a){try{let s=(await o.A.post("/reorder/menu",{data:e,parent_id:a})).data;g((e=>!e)),(0,u.WU)({message:s.message,displayClass:s.status})}catch(l){var s,t;(0,u.WU)({message:(null===(s=l.response.data)||void 0===s?void 0:s.message)||(null===(t=l.response)||void 0===t?void 0:t.message),displayClass:"failure"})}}(e,a)})})]})},e.id)})])),E(e.subMenu))}))};(0,i.useEffect)((()=>{m&&D(m)}),[m]),(0,i.useEffect)((()=>{!async function(e){try{const a=await o.A.get("/homemenu",{params:e});let n=a.data;A([]),v(null===n||void 0===n?void 0:n.data),s(null===n||void 0===n?void 0:n.data.map(((e,s,n)=>({...e,srno:s+1,parent_name:e.parent_id===e.id?"Main Menu":P(e.id,e.parent_id,a.data.data),menu_url:e.menu_url.includes("http")?(0,h.jsx)("a",{href:e.menu_url,target:"_blank",rel:"noopener noreferrer",children:e.menu_url}):e.menu_url,actions:(0,h.jsxs)("div",{className:"d-flex justify-content-evenly",children:[(0,h.jsx)("button",{type:"button",className:"btn btn-sm btn-warning",onClick:a=>{N(e),_(!0)},children:(0,h.jsx)(l.g,{icon:t.LFz})}),(0,h.jsx)("button",{type:"button",className:"btn btn-sm btn-danger ms-2",onClick:a=>M({modal:!0,data:e}),children:(0,h.jsx)(l.g,{icon:t.yLS})}),(0,h.jsx)("div",{className:"text-center p-1",children:(0,h.jsx)(r.A.Check,{defaultChecked:1===e.status,type:"switch",id:"custom-switch",onClick:a=>{!async function(e){try{let a=(await o.A.post("/homemenu/disable",e)).data;(0,u.WU)({message:a.message,displayClass:a.status})}catch(t){var a,s;(0,u.WU)({message:(null===(a=t.response.data)||void 0===a?void 0:a.message)||(null===(s=t.response)||void 0===s?void 0:s.message),displayClass:"failure"})}}({id:e.id,status:a.target.checked?1:0})}})})]})}))))}catch(i){var a,n;(0,u.WU)({message:(null===(a=i.response.data)||void 0===a?void 0:a.message)||(null===(n=i.response)||void 0===n?void 0:n.message),displayClass:"failure"})}}()}),[y,U,f]);const R=e=>{let{name:a,heading:s}=e;return(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsx)(n.D0,{id:"floating"+a,name:a,type:"text",className:"form-control",placeholder:s}),(0,h.jsxs)("label",{htmlFor:"floating"+a,children:[(0,h.jsx)("font",{color:"red",children:"* "}),s]}),(0,h.jsx)(n.Kw,{name:a,children:e=>(0,h.jsx)("div",{className:"alert alert-danger",children:e})})]})})};return(0,h.jsxs)("div",{className:"px-3",children:[(0,h.jsx)("div",{className:"text-center p-2",children:(0,h.jsx)("h2",{children:"Manage Links"})}),(0,h.jsxs)("div",{className:"d-flex justify-content-between",children:[a&&(0,h.jsxs)("span",{className:"d-flex py-2",children:["Links\xa0\xa0",(0,h.jsx)("div",{className:"form-check form-switch",children:(0,h.jsx)("input",{className:"form-check-input",type:"checkbox",role:"switch",checked:C,id:"flexSwitchCheckDefault",onChange:e=>w(e.target.checked)})}),"Tree"]}),(0,h.jsxs)("button",{type:"button",className:"btn rounded-5 btn-success",onClick:e=>{N(!1),_(!0)},children:[(0,h.jsx)(l.g,{icon:t.QLR})," Add Link"]})]}),C&&F&&(0,h.jsxs)("div",{className:"fade-in-top my-2 card p-4",children:[(0,h.jsx)("h4",{className:"mb-0",children:"Menu Tree"}),(0,h.jsx)("hr",{}),F&&F.sort(((e,a)=>e.order_id-a.order_id)).map(((e,a)=>(0,h.jsx)(W,{item:e},a)))]}),!C&&(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"col-lg-12 col-sm-12",children:[(0,h.jsx)("div",{className:"depttableSection table-responsive",style:{wordBreak:"break-word"},children:a?(null===a||void 0===a?void 0:a.length)>0&&(0,h.jsx)(x.A,{data:a,columns:[{text:"Sr.No.",dataField:"srno"},{text:"Title",dataField:"title"},{text:"Menu URL",dataField:"menu_url"},{text:"Parent",dataField:"parent_name"},{text:"Order ID",dataField:"order_id"},{text:"Actions",dataField:"actions"}],keyField:"srno",headerClasses:"admin-allTable_header"}):(0,h.jsx)(c.A,{})}),(0,h.jsx)("hr",{}),(0,h.jsxs)("div",{className:"card p-3 mb-4",children:[(0,h.jsx)("div",{className:"text-center",children:(0,h.jsx)("h5",{className:"my-3",children:"Edit - Drag and Drop Menu for Rearrange"})}),(0,h.jsx)("div",{className:"row",children:L})]})]})}),(0,h.jsxs)(d.A,{show:y,onHide:e=>_(!1),centered:!0,size:"lg",children:[(0,h.jsx)(d.A.Header,{className:"bgTheme text-light",children:(0,h.jsxs)(d.A.Title,{children:[" ",k?"Edit":"Add Link"," ",null===k||void 0===k?void 0:k.title," "]})}),(0,h.jsx)(d.A.Body,{children:(0,h.jsx)(n.l1,{initialValues:{id:(null===k||void 0===k?void 0:k.id)||"",title:(null===k||void 0===k?void 0:k.title)||"",parent_id:(null===k||void 0===k?void 0:k.parent_id)||"",menu_url:(null===k||void 0===k?void 0:k.menu_url)||"",order_id:(null===k||void 0===k?void 0:k.order_id)||"",type:k?"URL":""},enableReinitialize:!0,onSubmit:async e=>{b(!0),k?await async function(e){try{if(!e.menu_url)return(0,u.WU)({message:"Please Select a File or Link.",displayClass:"danger"}),null;(e.menu_url instanceof File||e.menu_url instanceof Blob)&&(e.menu_url=await(0,u.ZP)(e.menu_url,"homemenuFiles"),e.menu_url="https://mncsite.bynaricexam.com/data/"+e.menu_url);let a=(await o.A.put("/homemenu",e)).data;_(!1),(0,u.WU)({message:a.message,displayClass:a.status})}catch(t){var a,s;(0,u.WU)({message:(null===(a=t.response.data)||void 0===a?void 0:a.message)||(null===(s=t.response)||void 0===s?void 0:s.message),displayClass:"failure"})}}(e):await async function(e){try{if(!e.menu_url)return(0,u.WU)({message:"Please Select a File or Link.",displayClass:"danger"}),null;(e.menu_url instanceof File||e.menu_url instanceof Blob)&&(e.menu_url=await(0,u.ZP)(e.menu_url,"homemenuFiles"),e.menu_url="https://mncsite.bynaricexam.com/data/"+e.menu_url);let a=(await o.A.post("/homemenu",e)).data;_(!1),(0,u.WU)({message:a.message,displayClass:a.status})}catch(t){var a,s;(0,u.WU)({message:(null===(a=t.response.data)||void 0===a?void 0:a.message)||(null===(s=t.response)||void 0===s?void 0:s.message),displayClass:"failure"})}}(e),b(!1)},children:e=>{let{values:s,setFieldValue:t}=e;return(0,h.jsxs)(n.lV,{children:[(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsxs)(n.D0,{id:"floatingType",name:"type",as:"select",value:s.type,className:"form-control",placeholder:"Type",children:[(0,h.jsx)("option",{value:"",children:"Select Type"}),(0,h.jsx)("option",{value:"PDF",children:"Link with PDF"}),(0,h.jsx)("option",{value:"URL",children:"Link with URL"})]}),(0,h.jsxs)("label",{htmlFor:"floatingType",children:[(0,h.jsx)("font",{color:"red",children:"* "}),"Type"]})]}),(0,h.jsx)(R,{name:"title",heading:"Title"}),"URL"==s.type&&(0,h.jsx)(R,{name:"menu_url",heading:"Menu URL"}),"PDF"==s.type&&(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsx)("input",{id:"floatingFile",type:"file",accept:"application/pdf",className:"form-control",onChange:e=>{const a=e.currentTarget.files[0];if(a){if(!("application/pdf"===a.type||a.name.toLowerCase().endsWith(".pdf")))return alert("Please upload a valid PDF file."),void(e.target.value="");t("menu_url",a)}}}),(0,h.jsxs)("label",{htmlFor:"floatingFile",children:[(0,h.jsx)("font",{color:"red",children:"* "}),"Select File"]})]}),(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsxs)(n.D0,{id:"floatingparent_id",name:"parent_id",as:"select",value:s.parent_id,className:"form-control",placeholder:"Parent ID",children:[(0,h.jsx)("option",{value:"",children:"Select Parent ID"}),(null===k||void 0===k?void 0:k.id)&&(0,h.jsx)("option",{value:null===k||void 0===k?void 0:k.id,children:"Main Menu"}),a&&(null===a||void 0===a?void 0:a.map((e=>"#"===e.menu_url&&(0,h.jsxs)("option",{value:e.id,children:[e.title,e.parent_id!==e.id&&P(e.id,e.parent_id,a)]},e.id))))]}),(0,h.jsx)("label",{htmlFor:"floatingparent_id",children:"Parent ID"}),(0,h.jsx)(n.Kw,{name:"parent_id",children:e=>(0,h.jsx)("div",{className:"alert alert-danger",children:e})})]}),(0,h.jsx)("hr",{}),(0,h.jsxs)("div",{className:"text-center py-3",children:[(0,h.jsx)("button",{type:"submit",className:"btn btn-primary mx-2",disabled:j,children:j?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"\xa0Loading..."]}):"Submit"}),(0,h.jsx)("button",{type:"button",className:"btn btn-danger mx-2",onClick:e=>_(!1),disabled:j,children:"Close"})]})]})}})})]}),(0,h.jsxs)(d.A,{show:U.modal,centered:!0,onHide:e=>M({modal:!1,data:""}),children:[(0,h.jsx)(d.A.Header,{children:(0,h.jsx)(d.A.Title,{children:"Delete"})}),(0,h.jsxs)(d.A.Body,{children:["Do you really want to delete ?",(0,h.jsx)("br",{}),"Title : ",(0,h.jsx)("b",{children:null===(e=U.data)||void 0===e?void 0:e.title})]}),(0,h.jsxs)(d.A.Footer,{children:[(0,h.jsx)("button",{type:"button",className:"btn btn-danger",onClick:e=>{var a;!async function(e){try{let a=(await o.A.delete("/homemenu",{params:{id:e.id}})).data;M({modal:!1,data:""}),(0,u.WU)({message:a.message,displayClass:a.status})}catch(t){var a,s;(0,u.WU)({message:(null===(a=t.response.data)||void 0===a?void 0:a.message)||(null===(s=t.response)||void 0===s?void 0:s.message),displayClass:"failure"})}}({id:null===(a=U.data)||void 0===a?void 0:a.id})},children:"Delete"}),(0,h.jsx)("button",{type:"button",className:"btn btn-primary",onClick:e=>M({modal:!1,data:""}),children:"Cancel"})]})]})]})}}}]);