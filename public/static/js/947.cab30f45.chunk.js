"use strict";(self.webpackChunkmnc_frontend=self.webpackChunkmnc_frontend||[]).push([[947],{5947:(e,a,t)=>{t.r(a),t.d(a,{default:()=>x});var s=t(9324),l=t(4959),i=t(3939),d=t(9950),n=t(2902),c=t(2776),o=t(9262),r=t(7965),m=t(1261),u=t(9671),g=t(6030),h=t(4414);const x=()=>{var e;const[a,t]=(0,d.useState)([]),[x,y]=(0,d.useState)([]),[v,j]=(0,d.useState)(!0),[b,f]=(0,d.useState)(""),[p,N]=(0,d.useState)(!1),[C,A]=(0,d.useState)(null),[w,S]=(0,d.useState)({modal:!1,data:null}),{categories:F}=(0,g.A)("videoCategories");(0,d.useEffect)((()=>{(async()=>{j(!0);try{const e=await o.A.get("/video-gallery/listing");t(e.data.data||[])}catch(e){(0,u.WU)({message:e.message||"Failed to load videos",displayClass:"failure"})}finally{j(!1)}})()}),[]),(0,d.useEffect)((()=>{if(!F.length)return;j(!0);const e=b?a.filter((e=>String(e.category)===String(b))):a,i=Object.fromEntries(F.map((e=>[String(e.value),e.label]))),d=e.map(((e,a)=>({...e,srno:a+1,categoryName:i[String(e.category)]||"N/A",file:(0,h.jsx)("iframe",{width:"200",height:"120",src:e.file.replace("watch?v=","embed/"),title:e.title,frameBorder:"0",allowFullScreen:!0}),actions:(0,h.jsxs)("div",{className:"d-flex gap-2 justify-content-center",children:[(0,h.jsx)("button",{className:"btn btn-sm btn-warning",onClick:()=>{A(e),N(!0)},children:(0,h.jsx)(l.g,{icon:s.LFz})}),(0,h.jsx)("button",{className:"btn btn-sm btn-danger ms-2",onClick:()=>S({modal:!0,data:e}),children:(0,h.jsx)(l.g,{icon:s.yLS})}),(0,h.jsx)("div",{className:"text-center p-1",children:(0,h.jsx)(c.A.Check,{defaultChecked:1===e.status,type:"switch",onClick:a=>async function(e){let{id:a,status:s}=e;try{const e=await o.A.put("/video-gallery/disable",{id:a,status:s});(0,u.WU)({message:e.data.message,displayClass:e.data.status});const l=await o.A.get("/video-gallery/listing");t(l.data.data||[])}catch(d){var l,i;(0,u.WU)({message:(null===(l=d.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||d.message,displayClass:"failure"})}}({id:e.id,status:a.target.checked?1:0})})})]})})));y(d),j(!1)}),[a,F,b,p,w]);return(0,h.jsxs)("div",{className:"px-3",children:[(0,h.jsx)("div",{className:"text-center p-2",children:(0,h.jsx)("h3",{children:"Manage Video Gallery"})}),(0,h.jsxs)("button",{className:"btn rounded-5 btn-success mb-3",onClick:()=>{A(null),N(!0)},children:[(0,h.jsx)(l.g,{icon:s.QLR})," Add Video"]}),(0,h.jsx)("div",{className:"mb-3 float-end",children:(0,h.jsxs)("select",{id:"categoryFilter",className:"form-select",value:b,onChange:e=>{f(e.target.value)},children:[(0,h.jsx)("option",{value:"",children:"All Categories"}),F.map((e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value)))]})}),(0,h.jsx)("div",{className:"depttableSection my-3",children:v?(0,h.jsx)(r.A,{}):(0,h.jsx)(m.A,{data:x,columns:[{text:"Sr.No.",dataField:"srno"},{text:"Title",dataField:"title"},{text:"Video",dataField:"file"},{text:"Category",dataField:"categoryName"},{text:"Actions",dataField:"actions"}],keyField:"srno",headerClasses:"admin-allTable_header",noDataIndication:()=>(0,h.jsx)("div",{children:"No videos found."})})}),(0,h.jsxs)(n.A,{show:p,onHide:()=>N(!1),centered:!0,size:"lg",children:[(0,h.jsx)(n.A.Header,{className:"bgTheme text-light",children:(0,h.jsxs)(n.A.Title,{children:[C?"Edit":"Add"," Video"]})}),(0,h.jsx)(n.A.Body,{children:(0,h.jsx)(i.l1,{initialValues:{id:(null===C||void 0===C?void 0:C.id)||"",title:(null===C||void 0===C?void 0:C.title)||"",category:(null===C||void 0===C?void 0:C.category)||"",file:(null===C||void 0===C?void 0:C.file)||""},enableReinitialize:!0,onSubmit:(e,a)=>{let{setSubmitting:s}=a;C?async function(e,a){try{const s=await o.A.put("/video-gallery/update",e);a(!1),N(!1),(0,u.WU)({message:s.data.message,displayClass:s.data.status});const l=await o.A.get("/video-gallery/listing");t(l.data.data||[])}catch(s){a(!1),(0,u.WU)({message:s.message||"Failed to update",displayClass:"failure"})}}(e,s):async function(e,a){try{const s=await o.A.post("/video-gallery/add",e);a(!1),N(!1),(0,u.WU)({message:s.data.message,displayClass:s.data.status});const l=await o.A.get("/video-gallery/listing");t(l.data.data||[])}catch(s){a(!1),(0,u.WU)({message:s.message||"Failed to add",displayClass:"failure"})}}(e,s)},children:e=>{let{isValid:a,dirty:t,isSubmitting:s}=e;return(0,h.jsxs)(i.lV,{children:[(0,h.jsxs)("div",{className:"row",children:[(0,h.jsx)("div",{className:"col-12",children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsx)(i.D0,{name:"title",type:"text",className:"form-control"}),(0,h.jsx)("label",{htmlFor:"title",children:"Title"}),(0,h.jsx)(i.Kw,{name:"title",component:"div",className:"text-danger"})]})}),(0,h.jsx)("div",{className:"col-12",children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsx)(i.D0,{name:"file",type:"text",className:"form-control"}),(0,h.jsx)("label",{htmlFor:"file",children:"YouTube URL"}),(0,h.jsx)(i.Kw,{name:"file",component:"div",className:"text-danger"})]})}),(0,h.jsx)("div",{className:"col-12",children:(0,h.jsxs)("div",{className:"form-floating mb-3",children:[(0,h.jsxs)(i.D0,{as:"select",name:"category",className:"form-select",children:[(0,h.jsx)("option",{value:"",children:"Select Category"}),F.map((e=>(0,h.jsx)("option",{value:e.value,children:e.label},e.value)))]}),(0,h.jsx)("label",{htmlFor:"category",children:"Category"}),(0,h.jsx)(i.Kw,{name:"category",component:"div",className:"text-danger"})]})})]}),(0,h.jsxs)("div",{className:"text-center mt-4",children:[(0,h.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:!a||!t||s,children:s?"Submitting...":"Submit"}),(0,h.jsx)("button",{type:"button",className:"btn btn-secondary ms-2",onClick:()=>N(!1),disabled:s,children:"Cancel"})]})]})}})})]}),(0,h.jsxs)(n.A,{show:w.modal,onHide:()=>S({modal:!1,data:null}),centered:!0,children:[(0,h.jsx)(n.A.Header,{children:(0,h.jsx)(n.A.Title,{children:"Confirm Delete"})}),(0,h.jsxs)(n.A.Body,{children:["Are you sure you want to delete video: ",(0,h.jsx)("strong",{children:null===(e=w.data)||void 0===e?void 0:e.title}),"?"]}),(0,h.jsxs)(n.A.Footer,{children:[(0,h.jsx)("button",{className:"btn btn-danger",onClick:()=>async function(e){try{const a=await o.A.delete("/video-gallery/delete",{params:{id:e.id}});S({modal:!1,data:null}),(0,u.WU)({message:a.data.message,displayClass:a.data.status});const s=await o.A.get("/video-gallery/listing");t(s.data.data||[])}catch(a){(0,u.WU)({message:a.message||"Delete failed",displayClass:"failure"})}}(w.data),children:"Delete"}),(0,h.jsx)("button",{className:"btn btn-secondary",onClick:()=>S({modal:!1,data:null}),children:"Cancel"})]})]})]})}}}]);